# Vessel_segmentation
This public repository contains code for automated vessel segmentation from MRI. The algorithm was developed by Dr. Janine Lupo's group in the Department of Radiology and Biomedical Imaging at the University of California San Francisco.

Our approach builds upon the Frangi vessel enhancement method, providing the vessel segmentation with the advantage of maintaining accurate vessel shape for improved radii estimates. The algorithm automatically determines the appropriate set of filter scales for each vessel by first calculating the radii of large vessels using intensity-based thresholding followed by discrete distance transforms. From the output of the adaptive Frangi filter, Fast Marching was performed on the input images to obtain the binary image. This approach can be used to segment arteries from MRA and veins from SWI. Voxel-wise measures of vessel radii were generated by employing a Euclidean distance transform. Histograms of the vessel radii distribution were generated to depict vessel radii distribution.

REVELANT PUBLICATIONS:
Avadiappan S, Payabvash S, Morrison MA et al. A fully automated method for segmenting arteries and quantifying vessel radii on magnetic resonance angiography images of varying projection thickness. Frontiers in Neuroscience: Brain Imaging Methods, 2020.  https://doi.org/10.3389/fnins.2020.00537

USAGE:
1.	Download Ves_seg_protected.zip. A sample.mat MRA image volume has been included for demo.
2.	In the file Call_AdaptiveFrangi.m, add the path where ves_seg_protected folder is located.
3.	Replace sample.mat with your image volume and run the rest of the code.
4.	The program outputs segmented vessels and the vessel radii map for the entire 3D volume as well as the maximum intensity projected image. 
